<template>
  <f-main>
    <f-text center>
      <f-avatar
        :size="160"
        round
        src="https://jf-temp-1301446188.cos.ap-guangzhou.myqcloud.com/logo2"
      />
    </f-text>

    <f-divider margin="32px" color="rgb(224, 224, 224)"></f-divider>

    <f-text center
      >ğŸƒ å¯¹äºå¯æ§çš„äº‹æƒ…ä¿æŒè­¦æƒ• , å¯¹äºä¸å¯æ§çš„äº‹æƒ…ä¿æŒä¹è§‚ã€‚
    </f-text>

    <f-divider margin="32px" color="rgb(224, 224, 224)"></f-divider>

    <f-text bold>å†…å®¹</f-text>
    <f-text>âš¡ è®°å½•å¼€å‘ä¸­ç¢°åˆ°çš„ä¸œè¥¿</f-text>
    <f-text>ğŸŒ² Vue çš„å‘¨è¾¹ç”Ÿæ€</f-text>
    <f-text>ğŸ“Œ React ç›¸å…³</f-text>
    <f-text>ğŸ”¨ java ç›¸å…³</f-text>
    <f-text>ğŸ† é¢è¯• ç›¸å…³</f-text>

    <f-divider margin="32px" color="rgb(224, 224, 224)"></f-divider>

    <f-text bold>ä¸ªæ€§æ ‡ç­¾</f-text>

    <iframe
      id="myTag"
      src="https://gtols.netlify.app/#/tag"
      height="350"
      class="iframe"
      frameborder="0"
    />
    <iframe
      id="myRemark"
      src="https://hfymark.netlify.app/.netlify/functions/comment"
      class="iframeMark"
      frameborder="0"
    />
    <!-- height="500" -->
    <!-- <div style="height: 350px; width: 100%" /> -->
  </f-main>
</template>

<script setup>
  import { onMounted } from 'vue'
  function restry(iframe) {
    var retryCount = 0 // åˆå§‹åŒ–é‡è¯•æ¬¡æ•°
    var maxRetries = 30 // æœ€å¤§é‡è¯•æ¬¡æ•°
    var timeoutDuration = 5000 // è¶…æ—¶æ—¶é—´ï¼Œå•ä½æ¯«ç§’
    function retryIframeLoad() {
      if (retryCount < maxRetries) {
        console.log('é‡è¯•åŠ è½½...')
        const src = iframe.src // å…ˆæ¸…ç©º srcï¼Œé˜²æ­¢é‡å¤åŠ è½½ç›¸åŒå†…å®¹
        iframe.src = '' // å…ˆæ¸…ç©º srcï¼Œé˜²æ­¢é‡å¤åŠ è½½ç›¸åŒå†…å®¹
        setTimeout(function () {
          iframe.src = src // é‡æ–°åŠ è½½iframeå†…å®¹
        }, 100) // è®¾ç½®å°çš„å»¶è¿Ÿï¼Œä»¥ç¡®ä¿ iframe src è¢«æ¸…ç©ºåå†é‡æ–°åŠ è½½
        retryCount++
      } else {
        console.log('åŠ è½½å¤±è´¥ï¼Œè¶…å‡ºæœ€å¤§é‡è¯•æ¬¡æ•°ï¼')
      }
    }
    // æ£€æµ‹ iframe æ˜¯å¦åŠ è½½æˆåŠŸ
    iframe.onload = function () {
      console.log('Iframe åŠ è½½æˆåŠŸ!')
    }
    // æ£€æµ‹è¶…æ—¶
    setTimeout(function () {
      if (!iframe.contentWindow || !iframe.contentDocument) {
        console.log('Iframe åŠ è½½è¶…æ—¶ï¼Œå¼€å§‹é‡è¯•...')
        retryIframeLoad()
      }
    }, timeoutDuration) // è®¾ç½®è¶…æ—¶æ—¶é—´
  }
  onMounted(() => {
    var iframe1 = document.getElementById('myTag')
    var iframe2 = document.getElementById('myRemark')
    restry(iframe1)
    restry(iframe2)
  })
</script>
<style scoped>
  .iframe {
    width: 100%;
    /* position: absolute;
    right: 0;
    left: 0; */
    /* height: 400px; */
    /* @media (min-width: 1024px) {
        position: static;
      } */
  }
  .iframeMark {
    /* height: 100vh; */
    /* margin-top: 30px; */
    /* width: 100%;
    position: absolute;
    left: 0;
    right: 0; */
    margin-top: 100px;
    width: 100%;
    height: 500px;
  }

  .f-main {
    max-width: 620px;
    margin: 40px auto;
    box-sizing: border-box;
    padding: 40px;
    padding-bottom: 0;
    padding-bottom: 350px;

    @media (min-width: 1024px) {
      padding-bottom: 40px;
    }
  }

  .f-button-default {
    margin-left: 15px;
  }

  .f-text {
    display: block;
    line-height: 40px;
  }
</style>
